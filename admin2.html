<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PG Core Girls - Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #0f3c4c;
            --secondary-color: #5cb4e7;
            --success-color: #00b894;
            --warning-color: #fdcb6e;
            --danger-color: #d63031;
            --dark-color: #2d3436;
            --light-color: #f5f6fa;
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        body {
            background-color:rgba(232, 237, 239, 0.95);
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background:rgba(15,60,76,0.95);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar.collapsed .logo span,
        .sidebar.collapsed .nav-item span,
        .sidebar.collapsed .admin-info div,
        .sidebar.collapsed .logout-btn span {
            display: none;
        }

        .logo {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo i {
            font-size: 2rem;
        }

        .nav-menu {
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 25px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            cursor: pointer;
        }

        .nav-item i {
            width: 20px;
            font-size: 1.2rem;
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: white;
        }

        .sidebar-footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-info i {
            font-size: 2rem;
        }

        .admin-info small {
            opacity: 0.8;
        }

        .logout-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: all 0.3s ease;
        }

        .sidebar.collapsed + .main-content {
            margin-left: 80px;
        }

        /* Top Header - Modified: Removed search and notifications */
        .top-header {
            height: var(--header-height);
            background: white;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-color);
            display: none;
            margin-right: auto;
        }

        .date-display {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark-color);
            background: var(--light-color);
            padding: 5px 15px;
            border-radius: 20px;
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .stat-icon.blue {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .stat-icon.green {
            background: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
        }

        .stat-icon.orange {
            background: rgba(230, 126, 34, 0.1);
            color: #e67e22;
        }

        .stat-icon.red {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .stat-info h3 {
            font-size: 1rem;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-color);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 30px;
        }

        .recent-activities,
        .upcoming-dues {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .recent-activities h3,
        .upcoming-dues h3 {
            margin-bottom: 20px;
            color: var(--dark-color);
            font-size: 1.1rem;
        }

        .activity-list,
        .dues-list {
            max-height: 300px;
            overflow-y: auto;
        }

        /* Section Header */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .btn-primary:hover {
            background: #c2d3d8;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.3s ease;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-emergency {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .btn-emergency:hover {
            background: #b92d2d;
        }

        .btn-confirm {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: background 0.3s ease;
        }

        .btn-confirm:hover {
            background: #00a17a;
        }

        .btn-reject {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: background 0.3s ease;
        }

        .btn-reject:hover {
            background: #b92d2d;
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group select {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            outline: none;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 8px 15px;
            flex: 1;
            max-width: 300px;
        }

        .search-box i {
            color: #999;
            margin-right: 10px;
        }

        .search-box input {
            border: none;
            outline: none;
            width: 100%;
        }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--light-color);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark-color);
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .data-table tbody tr:hover {
            background: var(--light-color);
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-active {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .status-inactive {
            background: rgba(231, 76, 60, 0.1);
            color: #c0392b;
        }

        .status-pending {
            background: rgba(241, 196, 15, 0.1);
            color: #f39c12;
        }

        .status-emergency {
            background: rgba(214, 48, 49, 0.1);
            color: #d63031;
        }

        .status-resolved {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .status-confirmed {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .status-rejected {
            background: rgba(231, 76, 60, 0.1);
            color: #c0392b;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            margin: 0 5px;
            color: #666;
            transition: color 0.3s ease;
        }

        .action-btn:hover {
            color: var(--primary-color);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 25px;
        }

        .page-btn {
            background: white;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .page-info {
            color: #666;
        }

        /* Rooms Grid */
        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .room-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .room-card:hover {
            transform: translateY(-5px);
        }

        .room-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .room-number {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .room-type {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        .room-details {
            padding: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #666;
        }

        .detail-item span:first-child {
            font-weight: 500;
        }

        .room-footer {
            padding: 15px;
            background: var(--light-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rent-amount {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Summary Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .summary-card h4 {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .summary-card .amount {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--dark-color);
        }

        /* Complaints Grid */
        .complaints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .complaint-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .complaint-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .complaint-title {
            font-weight: 600;
            color: var(--dark-color);
        }

        .complaint-status {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .complaint-status.pending {
            background: rgba(241, 196, 15, 0.1);
            color: #f39c12;
        }

        .complaint-status.resolved {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .complaint-status.in-progress {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .complaint-meta {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            color: #666;
            font-size: 0.9rem;
        }

        .complaint-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Visitor Log Styles */
        .visitor-filters {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .visitor-status {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .visitor-status.checked-in {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .visitor-status.checked-out {
            background: rgba(149, 165, 166, 0.1);
            color: #7f8c8d;
        }

        /* Emergency Styles */
        .emergency-badge {
            background: var(--danger-color);
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
            100% {
                opacity: 1;
            }
        }

        .emergency-card {
            background: #fff5f5;
            border-left: 4px solid var(--danger-color);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(214, 48, 49, 0.1);
        }

        .emergency-type {
            font-weight: bold;
            color: var(--danger-color);
        }

        .emergency-time {
            font-size: 0.85rem;
            color: #7f8c8d;
        }

        /* Settings Grid */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .settings-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .settings-card h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark-color);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--primary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: var(--dark-color);
            font-size: 1.5rem;
        }

        .close {
            font-size: 2rem;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: var(--danger-color);
        }

        .modal-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* Additional Styles */
        .activity-item, .due-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .activity-item:last-child, .due-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .activity-icon.checkin {
            background: #00b894;
        }

        .activity-icon.payment {
            background: #fdcb6e;
        }

        .activity-icon.complaint {
            background: #d63031;
        }

        .activity-icon.visitor {
            background: #6c5ce7;
        }

        .activity-icon.emergency {
            background: #d63031;
        }

        .activity-details {
            flex: 1;
        }

        .activity-details p {
            margin-bottom: 3px;
            color: #2d3436;
        }

        .activity-details small {
            color: #999;
        }

        .due-info {
            flex: 1;
        }

        .due-info p {
            margin-bottom: 3px;
        }

        .due-info small {
            color: #e74c3c;
        }

        .progress-bar {
            height: 6px;
            background: #eee;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #00cec9);
            transition: width 0.3s ease;
        }

        /* Booking Requests Styles */
        .tab-container {
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 8px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            position: relative;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: #f0f0f0;
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .request-badge {
            background: var(--danger-color);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 8px;
        }

        .requests-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .request-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .request-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .request-card.pending {
            border-left: 4px solid var(--warning-color);
        }

        .request-card.confirmed {
            border-left: 4px solid var(--success-color);
        }

        .request-card.rejected {
            border-left: 4px solid var(--danger-color);
            opacity: 0.8;
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .request-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }

        .request-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-pending {
            background: rgba(241, 196, 15, 0.1);
            color: #f39c12;
        }

        .status-confirmed {
            background: rgba(46, 204, 113, 0.1);
            color: #27ae60;
        }

        .status-rejected {
            background: rgba(231, 76, 60, 0.1);
            color: #c0392b;
        }

        .request-details {
            margin: 15px 0;
        }

        .detail-row {
            display: flex;
            margin-bottom: 10px;
            color: #666;
            font-size: 0.95rem;
        }

        .detail-row .label {
            width: 120px;
            font-weight: 500;
            color: #888;
        }

        .request-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            background: white;
            border-radius: 10px;
            grid-column: 1 / -1;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0 !important;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-bar {
                flex-direction: column;
            }
            
            .search-box {
                max-width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 20px auto;
            }
        }
        /* PG Logo Styles */
.pg-logo {
    height: 30px;
    width: auto;
    margin-left: 5px;
    vertical-align: middle;
}

/* For collapsed sidebar */
.sidebar.collapsed .pg-logo {
    display: none;
}

/* Responsive adjustment */
@media (max-width: 768px) {
    .pg-logo {
        height: 30px;
    }
}
/* Enlarged Logo Styles - Image first, text after */
.logo {
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;  /* Increased gap for better spacing */
    font-size: 1.8rem;  /* Increased from 1.2rem */
    font-weight: bold;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.pg-logo {
    height: 45px;  /* Increased from 30px */
    width: auto;
    order: -1;  /* Ensures image comes first (though HTML already has it first) */
    vertical-align: middle;
}

/* For collapsed sidebar */
.sidebar.collapsed .pg-logo {
    display: none;
}

.sidebar.collapsed .logo span {
    display: none;
}

/* Responsive adjustment */
@media (max-width: 768px) {
    .logo {
        font-size: 1.5rem;  /* Slightly smaller on mobile but still enlarged */
    }
    .pg-logo {
        height: 38px;  /* Slightly smaller on mobile */
    }
}
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
    <div class="logo">
   
    <span>PG Core</span>
    <img src="images/logo.png" alt="PG Logo" class="pg-logo">
</div>
            
        <nav class="nav-menu">
    <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard', event)">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
    </a>
    <a href="#residents" class="nav-item" onclick="showSection('residents', event)">
        <i class="fas fa-users"></i>
        <span>Users</span>
    </a>
    <a href="#rooms" class="nav-item" onclick="showSection('rooms', event)">
        <i class="fas fa-bed"></i>
        <span>Rooms</span>
    </a>
    <a href="#payments" class="nav-item" onclick="showSection('payments', event)">
        <i class="fas fa-rupee-sign"></i>
        <span>Payments</span>
    </a>
    <a href="#complaints" class="nav-item" onclick="showSection('complaints', event)">
        <i class="fas fa-exclamation-triangle"></i>
        <span>Complaints</span>
    </a>
    <a href="#visitors" class="nav-item" onclick="showSection('visitors', event)">
        <i class="fas fa-address-book"></i>
        <span>Visitor Log</span>
    </a>
    <a href="#emergency" class="nav-item" onclick="showSection('emergency', event)">
        <i class="fas fa-ambulance"></i>
        <span>Emergency</span>
    </a>
    <a href="#settings" class="nav-item" onclick="showSection('settings', event)">
        <i class="fas fa-cog"></i>
        <span>Settings</span>
    </a>
</nav>
            
            <div class="sidebar-footer">
                <div class="admin-info">
                    <i class="fas fa-user-circle"></i>
                    <div>
                        <p>Admin Name</p>
                        <small>Super Admin</small>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Header - Modified: Removed search and notifications -->
            <header class="top-header">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="date-display">
                    <i class="fas fa-calendar"></i>
                    <span id="currentDate"></span>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <h1>Dashboard Overview</h1>
                
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Users</h3>
                            <p class="stat-number" id="totalResidents">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <i class="fas fa-bed"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Available Rooms</h3>
                            <p class="stat-number" id="availableRooms">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon orange">
                            <i class="fas fa-rupee-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Monthly Revenue</h3>
                            <p class="stat-number" id="monthlyRevenue">₹0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon red">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Pending Complaints</h3>
                            <p class="stat-number" id="pendingComplaints">0</p>
                        </div>
                    </div>
                </div>

                <!-- Additional Stats -->
                <div class="stats-grid" style="margin-top: 10px;">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(108, 92, 231, 0.1); color: #6c5ce7;">
                            <i class="fas fa-address-book"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Today's Visitors</h3>
                            <p class="stat-number" id="todayVisitors">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(214, 48, 49, 0.1); color: #d63031;">
                            <i class="fas fa-ambulance"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Active Emergencies</h3>
                            <p class="stat-number" id="activeEmergencies">0</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(255, 159, 67, 0.1); color: #ff9f43;">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Pending Bookings</h3>
                            <p class="stat-number" id="pendingBookings">2</p>
                        </div>
                    </div>
                </div>

                <!-- Activities and Dues -->
                <div class="dashboard-grid">
                    <!-- Recent Activities Card -->
                    <div class="recent-activities">
                        <h3>Recent Activities</h3>
                        <div class="activity-list" id="activityList">
                            <!-- Activities will be added here dynamically -->
                        </div>
                    </div>
                    
                    <!-- Upcoming Rent Dues Card -->
                    <div class="upcoming-dues">
                        <h3>Upcoming Rent Dues</h3>
                        <div class="dues-list" id="duesList">
                            <!-- Dues will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Residents Section with Booking Requests -->
            <section id="residents" class="content-section">
                <div class="section-header">
                    <h1>Users Management</h1>
                    <button class="btn-primary" onclick="openAddResidentModal()">
                        <i class="fas fa-plus"></i> Add New User
                    </button>
                </div>
                
                <!-- Tab Navigation -->
                <div class="tab-container">
                    <button class="tab-btn active" onclick="switchResidentTab('all')" id="tabAll">All Users</button>
                    <button class="tab-btn" onclick="switchResidentTab('requests')" id="tabRequests">
                        Booking Requests 
                        <span class="request-badge" id="requestCount">2</span>
                    </button>
                </div>
                
                <!-- All Users Tab Content -->
                <div id="allUsersContainer">
                    <div class="filter-bar">
                        <div class="filter-group">
                            <label>Filter by Room:</label>
                            <select id="roomFilter" onchange="filterResidents()">
                                <option value="all">All Rooms</option>
                                <option value="101">Room 101</option>
                                <option value="102">Room 102</option>
                                <option value="103">Room 103</option>
                                <option value="104">Room 104</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Filter by Status:</label>
                            <select id="statusFilter" onchange="filterResidents()">
                                <option value="all">All</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="residentSearch" placeholder="Search users..." onkeyup="searchResidents()">
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="data-table" id="residentsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Room No.</th>
                                    <th>Mobile</th>
                                    <th>Email</th>
                                    <th>Check-in Date</th>
                                    <th>Rent Status</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="residentsTableBody">
                                <!-- Residents data will be added here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="pagination">
                        <button class="page-btn" onclick="previousPage('residents')"><i class="fas fa-chevron-left"></i></button>
                        <span class="page-info" id="residentsPageInfo">Page 1 of 5</span>
                        <button class="page-btn" onclick="nextPage('residents')"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <!-- Booking Requests Tab Content -->
                <div id="requestsContainer" style="display: none;">
                    <div class="filter-bar">
                        <div class="filter-group">
                            <label>Show:</label>
                            <select id="bookingStatusFilter" onchange="filterBookings()">
                                <option value="all">All Bookings</option>
                                <option value="pending">Pending Requests</option>
                                <option value="confirmed">Confirmed Bookings</option>
                                <option value="rejected">Rejected Requests</option>
                            </select>
                        </div>
                        
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="bookingSearch" placeholder="Search bookings..." onkeyup="searchBookings()">
                        </div>
                    </div>
                    
                    <div class="requests-container" id="bookingRequestsList">
                        <!-- Booking requests will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Rooms Section -->
            <section id="rooms" class="content-section">
                <div class="section-header">
                    <h1>Rooms Management</h1>
                    <button class="btn-primary" onclick="openAddRoomModal()">
                        <i class="fas fa-plus"></i> Add New Room
                    </button>
                </div>
                
                <div class="rooms-grid" id="roomsGrid">
                    <!-- Rooms will be displayed here -->
                </div>
            </section>

            <!-- Payments Section -->
            <section id="payments" class="content-section">
                <div class="section-header">
                    <h1>Payments Management</h1>
                   
                </div>
                
                <div class="summary-cards">
                    <div class="summary-card">
                        <h4>Total Collected</h4>
                        <p class="amount" id="totalCollected">₹0</p>
                    </div>
                    <div class="summary-card">
                        <h4>Pending</h4>
                        <p class="amount" id="totalPending">₹0</p>
                    </div>
                    <div class="summary-card">
                        <h4>This Month</h4>
                        <p class="amount" id="thisMonthCollection">₹0</p>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="data-table" id="paymentsTable">
                        <thead>
                            <tr>
                                <th>Payment ID</th>
                                <th>Users Name</th>
                                <th>Room No.</th>
                                <th>Amount</th>
                                <th>Month</th>
                                <th>Payment Date</th>
                                <th>Method</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="paymentsTableBody">
                            <!-- Payments data will be added here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Complaints Section -->
            <section id="complaints" class="content-section">
                <h1>Complaints Management</h1>
                
                <div class="complaints-grid" id="complaintsGrid">
                    <!-- Complaints will be displayed here -->
                </div>
            </section>

            <!-- Visitor Log Section - Contact column added back -->
            <section id="visitors" class="content-section">
                <div class="section-header">
                    <h1>Visitor Log Management</h1>
                    <button class="btn-primary" onclick="openAddVisitorModal()">
                        <i class="fas fa-plus"></i> Add New Visitor
                    </button>
                </div>
                
                <div class="visitor-filters">
                    <div class="filter-group">
                        <label>Filter by Date:</label>
                        <input type="date" id="visitorDateFilter" onchange="filterVisitors()">
                    </div>
                    
                    <div class="filter-group">
                        <label>Filter by Status:</label>
                        <select id="visitorStatusFilter" onchange="filterVisitors()">
                            <option value="all">All</option>
                            <option value="checked-in">Checked In</option>
                            <option value="checked-out">Checked Out</option>
                        </select>
                    </div>
                    
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="visitorSearch" placeholder="Search visitors..." onkeyup="searchVisitors()">
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Visitor Name</th>
                                <th>Contact</th>   <!-- Contact column added back -->
                                <th>Users Visiting</th>
                                <th>Room No.</th>
                                <th>Check In Time</th>
                                <th>Check Out Time</th>
                                <th>Purpose</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="visitorsTableBody">
                            <!-- Visitor data will be added here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Emergency Section -->
            <section id="emergency" class="content-section">
                <div class="section-header">
                    <h1>Emergency Management</h1>
                    <button class="btn-emergency" onclick="openAddEmergencyModal()">
                        <i class="fas fa-plus"></i> Log Emergency
                    </button>
                </div>
                
                <div class="summary-cards">
                    <div class="summary-card" style="border-left: 4px solid #d63031;">
                        <h4>Active Emergencies</h4>
                        <p class="amount" id="activeEmergencyCount">0</p>
                    </div>
                    <div class="summary-card">
                        <h4>Resolved Today</h4>
                        <p class="amount" id="resolvedTodayCount">0</p>
                    </div>
                    <div class="summary-card">
                        <h4>Total This Month</h4>
                        <p class="amount" id="monthlyEmergencyCount">0</p>
                    </div>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>Filter by Status:</label>
                        <select id="emergencyStatusFilter" onchange="filterEmergencies()">
                            <option value="all">All</option>
                            <option value="active">Active</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Filter by Type:</label>
                        <select id="emergencyTypeFilter" onchange="filterEmergencies()">
                            <option value="all">All Types</option>
                            <option value="medical">Medical</option>
                            <option value="security">Security</option>
                            <option value="fire">Fire</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Users Name</th>
                                <th>Room No.</th>
                                <th>Emergency Type</th>
                                <th>Description</th>
                                <th>Reported Time</th>
                                <th>Status</th>
                                <th>Action Taken</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="emergencyTableBody">
                            <!-- Emergency data will be added here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <h1>Settings</h1>
                
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3><i class="fas fa-building"></i> PG Information</h3>
                        <form id="pgInfoForm">
                            <div class="form-group">
                                <label>PG Name</label>
                                <input type="text" value="PG Core Girls" id="pgName">
                            </div>
                            <div class="form-group">
                                <label>Address</label>
                                <textarea id="pgAddress">123, Main Street, City - 400001</textarea>
                            </div>
                            <div class="form-group">
                                <label>Contact Number</label>
                                <input type="text" value="+91 98765 43210" id="pgContact">
                            </div>
                            <button type="button" class="btn-primary" onclick="savePGInfo()">Save Changes</button>
                        </form>
                    </div>
                    
                    <div class="settings-card">
                        <h3><i class="fas fa-rupee-sign"></i> Rent Settings</h3>
                        <form id="rentSettingsForm">
                            <div class="form-group">
                                <label>Single Sharing Rent (per month)</label>
                                <input type="number" value="12000" id="singleSharingRent">
                            </div>
                            <div class="form-group">
                                <label>Double Sharing Rent (per month)</label>
                                <input type="number" value="9000" id="doubleSharingRent">
                            </div>
                            <div class="form-group">
                                <label>Triple Sharing Rent (per month)</label>
                                <input type="number" value="7500" id="tripleSharingRent">
                            </div>
                            <div class="form-group">
                                <label>Due Date (every month)</label>
                                <input type="number" value="5" id="dueDate" min="1" max="31">
                            </div>
                            <button type="button" class="btn-primary" onclick="saveRentSettings()">Save Changes</button>
                        </form>
                    </div>
                    
                    <div class="settings-card">
                        <h3><i class="fas fa-shield-alt"></i> Security Settings</h3>
                        <form id="securityForm">
                            <div class="form-group">
                                <label>Current Password</label>
                                <input type="password" id="currentPassword">
                            </div>
                            <div class="form-group">
                                <label>New Password</label>
                                <input type="password" id="newPassword">
                            </div>
                            <div class="form-group">
                                <label>Confirm Password</label>
                                <input type="password" id="confirmPassword">
                            </div>
                            <button type="button" class="btn-primary" onclick="changePassword()">Change Password</button>
                        </form>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Add Resident Modal -->
    <div id="addResidentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New User</h2>
                <span class="close" onclick="closeModal('addResidentModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addResidentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="residentName" required>
                        </div>
                        <div class="form-group">
                            <label>Room Number *</label>
                            <select id="residentRoom" required>
                                <option value="">Select Room</option>
                                <option value="101">101</option>
                                <option value="102">102</option>
                                <option value="103">103</option>
                                <option value="104">104</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Mobile Number *</label>
                            <input type="tel" id="residentMobile" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="residentEmail">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date of Birth</label>
                            <input type="date" id="residentDOB">
                        </div>
                        <div class="form-group">
                            <label>Occupation</label>
                            <input type="text" id="residentOccupation" placeholder="Student/Working">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Check-in Date *</label>
                            <input type="date" id="checkinDate" required>
                        </div>
                        <div class="form-group">
                            <label>Emergency Contact</label>
                            <input type="tel" id="emergencyContact">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Address</label>
                        <textarea id="residentAddress" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>ID Proof</label>
                        <input type="file" id="idProof" accept=".jpg,.jpeg,.png,.pdf">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('addResidentModal')">Cancel</button>
                <button class="btn-primary" onclick="saveResident()">Save Resident</button>
            </div>
        </div>
    </div>

    <!-- Add Room Modal -->
    <div id="addRoomModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Room</h2>
                <span class="close" onclick="closeModal('addRoomModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addRoomForm">
                    <div class="form-group">
                        <label>Room Number *</label>
                        <input type="text" id="roomNumber" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Room Type *</label>
                        <select id="roomType" required>
                            <option value="">Select Type</option>
                            <option value="single">Single Sharing</option>
                            <option value="double">Double Sharing</option>
                            <option value="triple">Triple Sharing</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Capacity *</label>
                        <input type="number" id="roomCapacity" min="1" max="4" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Rent per Month (₹) *</label>
                        <input type="number" id="roomRent" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Amenities</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" value="ac"> AC</label>
                            <label><input type="checkbox" value="attached"> Attached Bathroom</label>
                            <label><input type="checkbox" value="balcony"> Balcony</label>
                            <label><input type="checkbox" value="furnished"> Furnished</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Status</label>
                        <select id="roomStatus">
                            <option value="available">Available</option>
                            <option value="occupied">Occupied</option>
                            <option value="maintenance">Under Maintenance</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('addRoomModal')">Cancel</button>
                <button class="btn-primary" onclick="saveRoom()">Save Room</button>
            </div>
        </div>
    </div>

    <!-- Add Visitor Modal -->
    <div id="addVisitorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Visitor</h2>
                <span class="close" onclick="closeModal('addVisitorModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addVisitorForm">
                    <div class="form-group">
                        <label>Visitor Name *</label>
                        <input type="text" id="visitorName" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Contact Number *</label>
                        <input type="tel" id="visitorContact" required>
                    </div>
                    
                    <div class="form-group">
                        <label>User to Visit *</label>
                        <select id="visitorResident" required>
                            <option value="">Select User</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Purpose of Visit *</label>
                        <input type="text" id="visitorPurpose" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Check In Time *</label>
                        <input type="datetime-local" id="visitorCheckIn" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Vehicle Number (if any)</label>
                        <input type="text" id="visitorVehicle">
                    </div>
                    
                    <div class="form-group">
                        <label>ID Proof</label>
                        <input type="text" id="visitorIdProof" placeholder="ID Type & Number">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('addVisitorModal')">Cancel</button>
                <button class="btn-primary" onclick="saveVisitor()">Add Visitor</button>
            </div>
        </div>
    </div>

    <!-- Add Emergency Modal -->
    <div id="addEmergencyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Log Emergency</h2>
                <span class="close" onclick="closeModal('addEmergencyModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addEmergencyForm">
                    <div class="form-group">
                        <label>Resident Name *</label>
                        <select id="emergencyResident" required>
                            <option value="">Select Resident</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Emergency Type *</label>
                        <select id="emergencyType" required>
                            <option value="">Select Type</option>
                            <option value="medical">Medical Emergency</option>
                            <option value="security">Security Concern</option>
                            <option value="fire">Fire Emergency</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Description *</label>
                        <textarea id="emergencyDescription" rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Action Taken</label>
                        <textarea id="emergencyAction" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Reported By</label>
                        <input type="text" id="emergencyReportedBy">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('addEmergencyModal')">Cancel</button>
                <button class="btn-emergency" onclick="saveEmergency()">Log Emergency</button>
            </div>
        </div>
    </div>

    <!-- Check Out Visitor Modal -->
    <div id="checkOutVisitorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Check Out Visitor</h2>
                <span class="close" onclick="closeModal('checkOutVisitorModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="checkOutVisitorForm">
                    <input type="hidden" id="checkOutVisitorId">
                    <div class="form-group">
                        <label>Visitor Name</label>
                        <p id="checkOutVisitorNameDisplay" style="padding: 10px; background: #f5f6fa; border-radius: 8px;"></p>
                    </div>
                    
                    <div class="form-group">
                        <label>Check Out Time *</label>
                        <input type="datetime-local" id="visitorCheckOut" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Remarks</label>
                        <textarea id="checkOutRemarks" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('checkOutVisitorModal')">Cancel</button>
                <button class="btn-primary" onclick="checkOutVisitor()">Check Out</button>
            </div>
        </div>
    </div>

    <!-- Resolve Emergency Modal -->
    <div id="resolveEmergencyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Resolve Emergency</h2>
                <span class="close" onclick="closeModal('resolveEmergencyModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="resolveEmergencyForm">
                    <input type="hidden" id="resolveEmergencyId">
                    <div class="form-group">
                        <label>Emergency Details</label>
                        <p id="resolveEmergencyDetails" style="padding: 10px; background: #f5f6fa; border-radius: 8px;"></p>
                    </div>
                    
                    <div class="form-group">
                        <label>Resolution Details *</label>
                        <textarea id="emergencyResolution" rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Resolved By</label>
                        <input type="text" id="emergencyResolvedBy" value="Admin">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('resolveEmergencyModal')">Cancel</button>
                <button class="btn-primary" onclick="resolveEmergency()">Mark Resolved</button>
            </div>
        </div>
    </div>

    <script>
        // Sample Data
        let residents = [
            {
                id: 1,
                name: "Priya Sharma",
                room: "101",
                mobile: "9876543210",
                email: "priya@example.com",
                checkinDate: "2024-01-15",
                rentStatus: "paid",
                status: "active"
            },
            {
                id: 2,
                name: "Neha Patel",
                room: "102",
                mobile: "9876543211",
                email: "neha@example.com",
                checkinDate: "2024-02-01",
                rentStatus: "pending",
                status: "active"
            },
            {
                id: 3,
                name: "Riya Gupta",
                room: "103",
                mobile: "9876543212",
                email: "riya@example.com",
                checkinDate: "2024-01-20",
                rentStatus: "paid",
                status: "active"
            }
        ];

        let rooms = [
            {
                number: "101",
                type: "single",
                capacity: 1,
                occupants: 1,
                rent: 12000,
                amenities: ["ac", "attached", "furnished"],
                status: "occupied"
            },
            {
                number: "102",
                type: "double",
                capacity: 2,
                occupants: 1,
                rent: 9000,
                amenities: ["attached", "balcony"],
                status: "available"
            },
            {
                number: "103",
                type: "triple",
                capacity: 3,
                occupants: 1,
                rent: 7500,
                amenities: ["furnished"],
                status: "available"
            },
            {
                number: "104",
                type: "Four",
                capacity: 2,
                occupants: 0,
                rent: 6000,
                amenities: ["ac", "attached"],
                status: "available"
            }
        ];

        let payments = [
            {
                id: 1,
                residentName: "Priya Sharma",
                room: "101",
                amount: 12000,
                month: "January",
                date: "2024-01-25",
                method: "online",
                status: "completed"
            },
            {
                id: 2,
                residentName: "Riya Gupta",
                room: "103",
                amount: 9000,
                month: "January",
                date: "2024-01-22",
                method: "cash",
                status: "completed"
            }
        ];

        let complaints = [
            {
                id: 1,
                residentName: "Neha Patel",
                room: "102",
                title: "Water leakage in bathroom",
                description: "There is water leakage from the tap",
                date: "2024-02-10",
                status: "pending",
                priority: "high"
            },
            {
                id: 2,
                residentName: "Priya Sharma",
                room: "101",
                title: "WiFi not working",
                description: "Internet connection is down since morning",
                date: "2024-02-09",
                status: "in-progress",
                priority: "medium"
            }
        ];

        // Visitor Log Data - Added contact field
        let visitors = [
            {
                id: 1,
                name: "Amit Kumar",
                contact: "9988776655",           // Contact added
                residentName: "Priya Sharma",
                room: "101",
                checkIn: "2024-02-15T10:30",
                checkOut: "2024-02-15T12:45",
                purpose: "Family Visit",
                vehicle: "MH01AB1234",
                idProof: "Aadhar: 1234-5678-9012",
                status: "checked-out"
            },
            {
                id: 2,
                name: "Sneha Reddy",
                contact: "9876543210",           // Contact added
                residentName: "Neha Patel",
                room: "102",
                checkIn: "2024-02-15T14:00",
                checkOut: null,
                purpose: "Friend Visit",
                vehicle: "",
                idProof: "Driving License: DL-123456",
                status: "checked-in"
            }
        ];

        // Emergency Data
        let emergencies = [
            {
                id: 1,
                residentName: "Riya Gupta",
                room: "103",
                type: "medical",
                description: "High fever and severe headache",
                reportedTime: "2024-02-15T09:15",
                status: "active",
                actionTaken: "Doctor has been called",
                reportedBy: "Riya Gupta"
            },
            {
                id: 2,
                residentName: "Neha Patel",
                room: "102",
                type: "security",
                description: "Suspicious person at the gate",
                reportedTime: "2024-02-14T22:30",
                status: "resolved",
                actionTaken: "Security checked and cleared",
                reportedBy: "Security Guard",
                resolvedTime: "2024-02-14T23:00",
                resolvedBy: "Admin"
            }
        ];

        // Booking Requests Data with status
        let bookingRequests = [
            {
                id: 1,
                name: "Anjali Desai",
                mobile: "9988776655",
                email: "anjali@example.com",
                roomPreference: "101",
                roomType: "single",
                checkInDate: "2024-03-01",
                occupation: "Software Engineer",
                message: "Looking for long term stay",
                requestedOn: "2024-02-19T10:30",
                status: "pending"
            },
            {
                id: 2,
                name: "Kavya Sharma",
                mobile: "9876543210",
                email: "kavya@example.com",
                roomPreference: "102",
                roomType: "double",
                checkInDate: "2024-02-25",
                occupation: "Student",
                message: "Need accommodation for 6 months",
                requestedOn: "2024-02-19T09:15",
                status: "confirmed"
            },
            {
                id: 3,
                name: "Priya Mehta",
                mobile: "9876512345",
                email: "priya.m@example.com",
                roomPreference: "103",
                roomType: "triple",
                checkInDate: "2024-02-28",
                occupation: "Working Professional",
                message: "Immediate joining required",
                requestedOn: "2024-02-18T15:45",
                status: "rejected"
            }
        ];

        let activities = [
            {
                id: 1,
                description: "New resident Priya Sharma checked in",
                time: "2 hours ago",
                type: "checkin"
            },
            {
                id: 2,
                description: "Payment received from Riya Gupta - ₹6000",
                time: "5 hours ago",
                type: "payment"
            },
            {
                id: 3,
                description: "Complaint #1 marked as in-progress",
                time: "1 day ago",
                type: "complaint"
            },
            {
                id: 4,
                description: "Visitor Amit Kumar checked out",
                time: "3 hours ago",
                type: "visitor"
            },
            {
                id: 5,
                description: "Medical emergency reported for Riya Gupta",
                time: "4 hours ago",
                type: "emergency"
            }
        ];

        let dues = [
            {
                id: 1,
                residentName: "Neha Patel",
                room: "102",
                amount: 8000,
                dueDate: "2024-02-05",
                daysOverdue: 5
            }
        ];

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboardStats();
            displayCurrentDate();
            loadResidentsTable();
            loadRoomsGrid();
            loadPaymentsTable();
            loadComplaintsGrid();
            loadVisitorsTable();
            loadEmergencyTable();
            loadActivities();
            loadDues();
            loadBookingRequests();
            
            // Populate resident dropdowns in modals
            populateResidentDropdowns();
        });

        // Display Current Date
        function displayCurrentDate() {
            const date = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = date.toLocaleDateString('en-US', options);
        }

        // Toggle Sidebar
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        // Show Section
        function showSection(sectionId, event) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        // Update Dashboard Stats
        function updateDashboardStats() {
            document.getElementById('totalResidents').textContent = residents.length;
            
            const availableRooms = rooms.filter(room => room.status === 'available').length;
            document.getElementById('availableRooms').textContent = availableRooms;
            
            const monthlyRevenue = payments
                .filter(p => p.month === 'January')
                .reduce((sum, p) => sum + p.amount, 0);
            document.getElementById('monthlyRevenue').textContent = `₹${monthlyRevenue.toLocaleString()}`;
            
            const pendingComplaints = complaints.filter(c => c.status === 'pending').length;
            document.getElementById('pendingComplaints').textContent = pendingComplaints;
            
            const today = new Date().toISOString().split('T')[0];
            const todayVisitors = visitors.filter(v => v.checkIn.startsWith(today)).length;
            document.getElementById('todayVisitors').textContent = todayVisitors;
            
            const activeEmergencies = emergencies.filter(e => e.status === 'active').length;
            document.getElementById('activeEmergencies').textContent = activeEmergencies;
            
            const pendingBookings = bookingRequests.filter(r => r.status === 'pending').length;
            document.getElementById('pendingBookings').textContent = pendingBookings;
            document.getElementById('requestCount').textContent = pendingBookings;
        }

        // Switch between Residents tab and Requests tab
        function switchResidentTab(tab) {
            const tabAll = document.getElementById('tabAll');
            const tabRequests = document.getElementById('tabRequests');
            const allUsersContainer = document.getElementById('allUsersContainer');
            const requestsContainer = document.getElementById('requestsContainer');
            
            if (tab === 'all') {
                tabAll.classList.add('active');
                tabRequests.classList.remove('active');
                allUsersContainer.style.display = 'block';
                requestsContainer.style.display = 'none';
                loadResidentsTable();
            } else {
                tabAll.classList.remove('active');
                tabRequests.classList.add('active');
                allUsersContainer.style.display = 'none';
                requestsContainer.style.display = 'block';
                loadBookingRequests();
            }
        }

        // Load Booking Requests
        function loadBookingRequests() {
            const container = document.getElementById('bookingRequestsList');
            const filterValue = document.getElementById('bookingStatusFilter')?.value || 'all';
            
            let filteredRequests = bookingRequests;
            
            // Apply filter
            if (filterValue !== 'all') {
                filteredRequests = bookingRequests.filter(r => r.status === filterValue);
            }
            
            if (filteredRequests.length === 0) {
                container.innerHTML = '<div class="no-data">No booking requests found</div>';
                return;
            }
            
            container.innerHTML = '';
            filteredRequests.forEach(request => {
                const card = document.createElement('div');
                card.className = `request-card ${request.status}`;
                
                // Status badge class
                const statusClass = request.status === 'pending' ? 'status-pending' : 
                                   request.status === 'confirmed' ? 'status-confirmed' : 
                                   'status-rejected';
                
                // Status text
                const statusText = request.status === 'pending' ? 'Pending' : 
                                  request.status === 'confirmed' ? 'Confirmed' : 
                                  'Rejected';
                
                // Action buttons based on status
                let actionButtons = '';
                if (request.status === 'pending') {
                    actionButtons = `
                        <div class="request-actions">
                            <button class="btn-confirm" onclick="confirmBooking(${request.id})">
                                <i class="fas fa-check"></i> Confirm
                            </button>
                            <button class="btn-reject" onclick="rejectBooking(${request.id})">
                                <i class="fas fa-times"></i> Reject
                            </button>
                        </div>
                    `;
                } else {
                    actionButtons = `
                        <div class="request-actions">
                            <button class="btn-primary" onclick="viewBookingDetails(${request.id})" style="flex: 1;">
                                <i class="fas fa-eye"></i> View Details
                            </button>
                        </div>
                    `;
                }
                
                card.innerHTML = `
                    <div class="request-header">
                        <span class="request-name">${request.name}</span>
                        <span class="request-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="request-details">
                        <div class="detail-row">
                            <span class="label">Mobile:</span>
                            <span>${request.mobile}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Email:</span>
                            <span>${request.email}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Room Preference:</span>
                            <span>${request.roomPreference} (${request.roomType})</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Check-in Date:</span>
                            <span>${request.checkInDate}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Occupation:</span>
                            <span>${request.occupation}</span>
                        </div>
                    </div>
                    ${actionButtons}
                `;
                container.appendChild(card);
            });
        }

        // Filter bookings by status
        function filterBookings() {
            loadBookingRequests();
            updateDashboardStats();
        }

        // Search bookings
        function searchBookings() {
            const searchTerm = document.getElementById('bookingSearch').value.toLowerCase();
            const filterValue = document.getElementById('bookingStatusFilter').value;
            const container = document.getElementById('bookingRequestsList');
            
            let filtered = bookingRequests;
            
            // Apply status filter first
            if (filterValue !== 'all') {
                filtered = bookingRequests.filter(r => r.status === filterValue);
            }
            
            // Then apply search
            const searched = filtered.filter(request => 
                request.name.toLowerCase().includes(searchTerm) ||
                request.mobile.includes(searchTerm) ||
                request.email.toLowerCase().includes(searchTerm) ||
                request.roomPreference.includes(searchTerm)
            );
            
            if (searched.length === 0) {
                container.innerHTML = '<div class="no-data">No matching bookings found</div>';
                return;
            }
            
            container.innerHTML = '';
            searched.forEach(request => {
                const card = document.createElement('div');
                card.className = `request-card ${request.status}`;
                
                const statusClass = request.status === 'pending' ? 'status-pending' : 
                                   request.status === 'confirmed' ? 'status-confirmed' : 
                                   'status-rejected';
                
                const statusText = request.status === 'pending' ? 'Pending' : 
                                  request.status === 'confirmed' ? 'Confirmed' : 
                                  'Rejected';
                
                let actionButtons = '';
                if (request.status === 'pending') {
                    actionButtons = `
                        <div class="request-actions">
                            <button class="btn-confirm" onclick="confirmBooking(${request.id})">
                                <i class="fas fa-check"></i> Confirm
                            </button>
                            <button class="btn-reject" onclick="rejectBooking(${request.id})">
                                <i class="fas fa-times"></i> Reject
                            </button>
                        </div>
                    `;
                } else {
                    actionButtons = `
                        <div class="request-actions">
                            <button class="btn-primary" onclick="viewBookingDetails(${request.id})" style="flex: 1;">
                                <i class="fas fa-eye"></i> View Details
                            </button>
                        </div>
                    `;
                }
                
                card.innerHTML = `
                    <div class="request-header">
                        <span class="request-name">${request.name}</span>
                        <span class="request-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="request-details">
                        <div class="detail-row">
                            <span class="label">Mobile:</span>
                            <span>${request.mobile}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Email:</span>
                            <span>${request.email}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Room:</span>
                            <span>${request.roomPreference} (${request.roomType})</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Check-in:</span>
                            <span>${request.checkInDate}</span>
                        </div>
                    </div>
                    ${actionButtons}
                `;
                container.appendChild(card);
            });
        }

        // Confirm booking request
        function confirmBooking(requestId) {
            const request = bookingRequests.find(r => r.id === requestId);
            if (!request) return;
            
            // Update status to confirmed
            request.status = 'confirmed';
            
            // Create new resident from request
            const newResident = {
                id: residents.length + 1,
                name: request.name,
                room: request.roomPreference,
                mobile: request.mobile,
                email: request.email,
                checkinDate: request.checkInDate,
                rentStatus: "pending",
                status: "active"
            };
            
            // Add to residents
            residents.push(newResident);
            
            // Update room occupancy
            const room = rooms.find(r => r.number === request.roomPreference);
            if (room) {
                room.occupants += 1;
                if (room.occupants >= room.capacity) {
                    room.status = "occupied";
                }
            }
            
            // Refresh views
            loadBookingRequests();
            loadResidentsTable();
            populateResidentDropdowns();
            updateDashboardStats();
            
            // Add activity
            activities.unshift({
                id: activities.length + 1,
                description: `Booking confirmed for ${request.name}`,
                time: 'Just now',
                type: 'checkin'
            });
            loadActivities();
            
            alert(`Booking confirmed for ${request.name}`);
        }

        // Reject booking request
        function rejectBooking(requestId) {
            if (confirm('Are you sure you want to reject this booking request?')) {
                const request = bookingRequests.find(r => r.id === requestId);
                request.status = 'rejected';
                
                loadBookingRequests();
                updateDashboardStats();
                
                // Add activity
                activities.unshift({
                    id: activities.length + 1,
                    description: `Booking rejected for ${request.name}`,
                    time: 'Just now',
                    type: 'complaint'
                });
                loadActivities();
                
                alert('Booking request rejected');
            }
        }

        // View booking details
        function viewBookingDetails(requestId) {
            const request = bookingRequests.find(r => r.id === requestId);
            alert(`Booking Details:\nName: ${request.name}\nStatus: ${request.status}\nRoom: ${request.roomPreference}\nCheck-in: ${request.checkInDate}\nMessage: ${request.message}`);
        }

        // Load Residents Table
        function loadResidentsTable() {
            const tbody = document.getElementById('residentsTableBody');
            tbody.innerHTML = '';
            
            residents.forEach(resident => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${resident.id}</td>
                    <td>${resident.name}</td>
                    <td>${resident.room}</td>
                    <td>${resident.mobile}</td>
                    <td>${resident.email}</td>
                    <td>${resident.checkinDate}</td>
                    <td><span class="status-badge ${resident.rentStatus === 'paid' ? 'status-active' : 'status-pending'}">${resident.rentStatus}</span></td>
                    <td><span class="status-badge ${resident.status === 'active' ? 'status-active' : 'status-inactive'}">${resident.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="editResident(${resident.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn" onclick="viewResident(${resident.id})"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" onclick="deleteResident(${resident.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load Rooms Grid
        function loadRoomsGrid() {
            const grid = document.getElementById('roomsGrid');
            grid.innerHTML = '';
            
            rooms.forEach(room => {
                const roomCard = document.createElement('div');
                roomCard.className = 'room-card';
                
                const occupancyPercentage = (room.occupants / room.capacity) * 100;
                
                roomCard.innerHTML = `
                    <div class="room-header">
                        <span class="room-number">Room ${room.number}</span>
                        <span class="room-type">${room.type} Sharing</span>
                    </div>
                    <div class="room-details">
                        <div class="detail-item">
                            <span>Capacity:</span>
                            <span>${room.occupants}/${room.capacity}</span>
                        </div>
                        <div class="detail-item">
                            <span>Amenities:</span>
                            <span>${room.amenities.join(', ')}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: ${occupancyPercentage}%"></div>
                        </div>
                    </div>
                    <div class="room-footer">
                        <span class="rent-amount">₹${room.rent}/month</span>
                        <span class="status-badge ${room.status === 'available' ? 'status-active' : room.status === 'occupied' ? 'status-pending' : 'status-inactive'}">${room.status}</span>
                    </div>
                `;
                
                grid.appendChild(roomCard);
            });
        }

        // Load Payments Table
        function loadPaymentsTable() {
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';
            
            payments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${payment.id}</td>
                    <td>${payment.residentName}</td>
                    <td>${payment.room}</td>
                    <td>₹${payment.amount.toLocaleString()}</td>
                    <td>${payment.month}</td>
                    <td>${payment.date}</td>
                    <td>${payment.method}</td>
                    <td><span class="status-badge status-active">${payment.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewPayment(${payment.id})"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" onclick="downloadReceipt(${payment.id})"><i class="fas fa-download"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Update payment summaries
            const totalCollected = payments.reduce((sum, p) => sum + p.amount, 0);
            document.getElementById('totalCollected').textContent = `₹${totalCollected.toLocaleString()}`;
            
            const pendingAmount = dues.reduce((sum, d) => sum + d.amount, 0);
            document.getElementById('totalPending').textContent = `₹${pendingAmount.toLocaleString()}`;
            
            const thisMonth = payments
                .filter(p => p.month === 'January')
                .reduce((sum, p) => sum + p.amount, 0);
            document.getElementById('thisMonthCollection').textContent = `₹${thisMonth.toLocaleString()}`;
        }

        // Load Complaints Grid
        function loadComplaintsGrid() {
            const grid = document.getElementById('complaintsGrid');
            grid.innerHTML = '';
            
            complaints.forEach(complaint => {
                const complaintCard = document.createElement('div');
                complaintCard.className = 'complaint-card';
                complaintCard.innerHTML = `
                    <div class="complaint-header">
                        <span class="complaint-title">${complaint.title}</span>
                        <span class="complaint-status ${complaint.status}">${complaint.status}</span>
                    </div>
                    <p class="complaint-description">${complaint.description}</p>
                    <div class="complaint-meta">
                        <span><i class="fas fa-user"></i> ${complaint.residentName}</span>
                        <span><i class="fas fa-door-open"></i> Room ${complaint.room}</span>
                        <span><i class="fas fa-calendar"></i> ${complaint.date}</span>
                    </div>
                    <div class="complaint-actions">
                        <button class="btn-primary" onclick="updateComplaintStatus(${complaint.id}, 'in-progress')">Mark In Progress</button>
                        <button class="btn-secondary" onclick="updateComplaintStatus(${complaint.id}, 'resolved')">Resolve</button>
                    </div>
                `;
                grid.appendChild(complaintCard);
            });
        }

        // Load Visitors Table - Contact column displayed
        function loadVisitorsTable() {
            const tbody = document.getElementById('visitorsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            visitors.forEach(visitor => {
                const row = document.createElement('tr');
                const checkOutTime = visitor.checkOut ? visitor.checkOut : '-';
                const statusClass = visitor.status === 'checked-in' ? 'status-active' : 'status-inactive';
                
                row.innerHTML = `
                    <td>${visitor.id}</td>
                    <td>${visitor.name}</td>
                    <td>${visitor.contact || '-'}</td>   <!-- Contact column data -->
                    <td>${visitor.residentName}</td>
                    <td>${visitor.room}</td>
                    <td>${formatDateTime(visitor.checkIn)}</td>
                    <td>${visitor.checkOut ? formatDateTime(visitor.checkOut) : '-'}</td>
                    <td>${visitor.purpose}</td>
                    <td><span class="status-badge ${statusClass}">${visitor.status}</span></td>
                    <td>
                        ${visitor.status === 'checked-in' ? 
                            `<button class="action-btn" onclick="openCheckOutModal(${visitor.id})" style="color: #00b894;" title="Check Out"><i class="fas fa-sign-out-alt"></i></button>` : 
                            ''}
                        <button class="action-btn" onclick="viewVisitor(${visitor.id})"><i class="fas fa-eye"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Load Emergency Table
        function loadEmergencyTable() {
            const tbody = document.getElementById('emergencyTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Update summary counts
            const activeCount = emergencies.filter(e => e.status === 'active').length;
            document.getElementById('activeEmergencyCount').textContent = activeCount;
            
            const today = new Date().toISOString().split('T')[0];
            const resolvedToday = emergencies.filter(e => 
                e.status === 'resolved' && e.resolvedTime && e.resolvedTime.startsWith(today)
            ).length;
            document.getElementById('resolvedTodayCount').textContent = resolvedToday;
            
            const thisMonth = emergencies.filter(e => {
                const month = e.reportedTime.substring(0, 7);
                const currentMonth = new Date().toISOString().substring(0, 7);
                return month === currentMonth;
            }).length;
            document.getElementById('monthlyEmergencyCount').textContent = thisMonth;
            
            emergencies.forEach(emergency => {
                const row = document.createElement('tr');
                const statusClass = emergency.status === 'active' ? 'status-emergency' : 'status-resolved';
                
                row.innerHTML = `
                    <td>${emergency.id}</td>
                    <td>${emergency.residentName}</td>
                    <td>${emergency.room}</td>
                    <td><span class="emergency-type">${emergency.type}</span></td>
                    <td>${emergency.description.substring(0, 30)}${emergency.description.length > 30 ? '...' : ''}</td>
                    <td>${formatDateTime(emergency.reportedTime)}</td>
                    <td><span class="status-badge ${statusClass}">${emergency.status}</span></td>
                    <td>${emergency.actionTaken || '-'}</td>
                    <td>
                        ${emergency.status === 'active' ? 
                            `<button class="action-btn" onclick="openResolveEmergencyModal(${emergency.id})" style="color: #00b894;" title="Resolve"><i class="fas fa-check-circle"></i></button>` : 
                            ''}
                        <button class="action-btn" onclick="viewEmergency(${emergency.id})"><i class="fas fa-eye"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Format DateTime
        function formatDateTime(datetime) {
            if (!datetime) return '-';
            const date = new Date(datetime);
            return date.toLocaleString('en-IN', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Populate Resident Dropdowns
        function populateResidentDropdowns() {
            const visitorResidentSelect = document.getElementById('visitorResident');
            const emergencyResidentSelect = document.getElementById('emergencyResident');
            
            if (visitorResidentSelect) {
                visitorResidentSelect.innerHTML = '<option value="">Select Resident</option>';
                residents.filter(r => r.status === 'active').forEach(resident => {
                    const option = document.createElement('option');
                    option.value = resident.id;
                    option.textContent = `${resident.name} (Room ${resident.room})`;
                    visitorResidentSelect.appendChild(option);
                });
            }
            
            if (emergencyResidentSelect) {
                emergencyResidentSelect.innerHTML = '<option value="">Select Resident</option>';
                residents.forEach(resident => {
                    const option = document.createElement('option');
                    option.value = resident.id;
                    option.textContent = `${resident.name} (Room ${resident.room})`;
                    emergencyResidentSelect.appendChild(option);
                });
            }
        }

        // Load Activities
        function loadActivities() {
            const activityList = document.getElementById('activityList');
            activityList.innerHTML = '';
            
            activities.forEach(activity => {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                activityItem.innerHTML = `
                    <div class="activity-icon ${activity.type}">
                        <i class="fas fa-${activity.type === 'checkin' ? 'user-plus' : activity.type === 'payment' ? 'rupee-sign' : activity.type === 'complaint' ? 'exclamation-triangle' : activity.type === 'visitor' ? 'address-book' : 'ambulance'}"></i>
                    </div>
                    <div class="activity-details">
                        <p>${activity.description}</p>
                        <small>${activity.time}</small>
                    </div>
                `;
                activityList.appendChild(activityItem);
            });
        }

        // Load Dues
        function loadDues() {
            const duesList = document.getElementById('duesList');
            duesList.innerHTML = '';
            
            dues.forEach(due => {
                const dueItem = document.createElement('div');
                dueItem.className = 'due-item';
                dueItem.innerHTML = `
                    <div class="due-info">
                        <p><strong>${due.residentName}</strong> - Room ${due.room}</p>
                        <p>Amount: ₹${due.amount.toLocaleString()}</p>
                        <small>Due: ${due.dueDate} (${due.daysOverdue} days overdue)</small>
                    </div>
                    <button class="btn-primary" onclick="collectPayment(${due.id})">Collect</button>
                `;
                duesList.appendChild(dueItem);
            });
        }

        // Modal Functions
        function openAddResidentModal() {
            document.getElementById('addResidentModal').style.display = 'block';
        }

        function openAddRoomModal() {
            document.getElementById('addRoomModal').style.display = 'block';
        }

        function openAddVisitorModal() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('visitorCheckIn').value = `${year}-${month}-${day}T${hours}:${minutes}`;
            
            document.getElementById('addVisitorModal').style.display = 'block';
        }

        function openAddEmergencyModal() {
            document.getElementById('addEmergencyModal').style.display = 'block';
        }

        function openCheckOutModal(visitorId) {
            const visitor = visitors.find(v => v.id === visitorId);
            if (visitor) {
                document.getElementById('checkOutVisitorId').value = visitor.id;
                document.getElementById('checkOutVisitorNameDisplay').textContent = visitor.name;
                
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                document.getElementById('visitorCheckOut').value = `${year}-${month}-${day}T${hours}:${minutes}`;
                
                document.getElementById('checkOutVisitorModal').style.display = 'block';
            }
        }

        function openResolveEmergencyModal(emergencyId) {
            const emergency = emergencies.find(e => e.id === emergencyId);
            if (emergency) {
                document.getElementById('resolveEmergencyId').value = emergency.id;
                document.getElementById('resolveEmergencyDetails').innerHTML = `
                    <strong>Resident:</strong> ${emergency.residentName}<br>
                    <strong>Type:</strong> ${emergency.type}<br>
                    <strong>Description:</strong> ${emergency.description}
                `;
                
                document.getElementById('resolveEmergencyModal').style.display = 'block';
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Filter Functions
        function filterResidents() {
            const roomFilter = document.getElementById('roomFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            console.log('Filtering residents:', { roomFilter, statusFilter });
        }

        function searchResidents() {
            const searchTerm = document.getElementById('residentSearch').value.toLowerCase();
            
            const filtered = residents.filter(resident => 
                resident.name.toLowerCase().includes(searchTerm) ||
                resident.room.includes(searchTerm) ||
                resident.mobile.includes(searchTerm)
            );
            
            const tbody = document.getElementById('residentsTableBody');
            tbody.innerHTML = '';
            
            filtered.forEach(resident => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${resident.id}</td>
                    <td>${resident.name}</td>
                    <td>${resident.room}</td>
                    <td>${resident.mobile}</td>
                    <td>${resident.email}</td>
                    <td>${resident.checkinDate}</td>
                    <td><span class="status-badge ${resident.rentStatus === 'paid' ? 'status-active' : 'status-pending'}">${resident.rentStatus}</span></td>
                    <td><span class="status-badge ${resident.status === 'active' ? 'status-active' : 'status-inactive'}">${resident.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="editResident(${resident.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn" onclick="viewResident(${resident.id})"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" onclick="deleteResident(${resident.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterVisitors() {
            const dateFilter = document.getElementById('visitorDateFilter').value;
            const statusFilter = document.getElementById('visitorStatusFilter').value;
            console.log('Filtering visitors:', { dateFilter, statusFilter });
        }

        function searchVisitors() {
            const searchTerm = document.getElementById('visitorSearch').value.toLowerCase();
            
            const filtered = visitors.filter(visitor => 
                visitor.name.toLowerCase().includes(searchTerm) ||
                (visitor.contact && visitor.contact.includes(searchTerm)) ||
                visitor.residentName.toLowerCase().includes(searchTerm)
            );
            
            const tbody = document.getElementById('visitorsTableBody');
            tbody.innerHTML = '';
            
            filtered.forEach(visitor => {
                const row = document.createElement('tr');
                const checkOutTime = visitor.checkOut ? visitor.checkOut : '-';
                const statusClass = visitor.status === 'checked-in' ? 'status-active' : 'status-inactive';
                
                row.innerHTML = `
                    <td>${visitor.id}</td>
                    <td>${visitor.name}</td>
                    <td>${visitor.contact || '-'}</td>
                    <td>${visitor.residentName}</td>
                    <td>${visitor.room}</td>
                    <td>${formatDateTime(visitor.checkIn)}</td>
                    <td>${visitor.checkOut ? formatDateTime(visitor.checkOut) : '-'}</td>
                    <td>${visitor.purpose}</td>
                    <td><span class="status-badge ${statusClass}">${visitor.status}</span></td>
                    <td>
                        ${visitor.status === 'checked-in' ? 
                            `<button class="action-btn" onclick="openCheckOutModal(${visitor.id})" style="color: #00b894;" title="Check Out"><i class="fas fa-sign-out-alt"></i></button>` : 
                            ''}
                        <button class="action-btn" onclick="viewVisitor(${visitor.id})"><i class="fas fa-eye"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterEmergencies() {
            const statusFilter = document.getElementById('emergencyStatusFilter').value;
            const typeFilter = document.getElementById('emergencyTypeFilter').value;
            console.log('Filtering emergencies:', { statusFilter, typeFilter });
        }

        // Save Functions
        function saveResident() {
            const newResident = {
                id: residents.length + 1,
                name: document.getElementById('residentName').value,
                room: document.getElementById('residentRoom').value,
                mobile: document.getElementById('residentMobile').value,
                email: document.getElementById('residentEmail').value,
                checkinDate: document.getElementById('checkinDate').value,
                status: 'active',
                rentStatus: 'pending'
            };
            
            residents.push(newResident);
            loadResidentsTable();
            populateResidentDropdowns();
            closeModal('addResidentModal');
            updateDashboardStats();
            
            activities.unshift({
                id: activities.length + 1,
                description: `New resident ${newResident.name} added`,
                time: 'Just now',
                type: 'checkin'
            });
            loadActivities();
            
            alert('Resident added successfully!');
        }

        function saveRoom() {
            const newRoom = {
                number: document.getElementById('roomNumber').value,
                type: document.getElementById('roomType').value,
                capacity: parseInt(document.getElementById('roomCapacity').value),
                rent: parseInt(document.getElementById('roomRent').value),
                amenities: Array.from(document.querySelectorAll('#addRoomForm .checkbox-group input:checked')).map(cb => cb.value),
                status: document.getElementById('roomStatus').value,
                occupants: 0
            };
            
            rooms.push(newRoom);
            loadRoomsGrid();
            closeModal('addRoomModal');
            updateDashboardStats();
            
            alert('Room added successfully!');
        }

        function saveVisitor() {
            const residentSelect = document.getElementById('visitorResident');
            const selectedResidentId = parseInt(residentSelect.value);
            const resident = residents.find(r => r.id === selectedResidentId);
            
            const newVisitor = {
                id: visitors.length + 1,
                name: document.getElementById('visitorName').value,
                contact: document.getElementById('visitorContact').value,   // Save contact
                residentName: resident.name,
                room: resident.room,
                checkIn: document.getElementById('visitorCheckIn').value,
                checkOut: null,
                purpose: document.getElementById('visitorPurpose').value,
                vehicle: document.getElementById('visitorVehicle').value,
                idProof: document.getElementById('visitorIdProof').value,
                status: 'checked-in'
            };
            
            visitors.push(newVisitor);
            loadVisitorsTable();
            closeModal('addVisitorModal');
            updateDashboardStats();
            
            activities.unshift({
                id: activities.length + 1,
                description: `New visitor ${newVisitor.name} for ${newVisitor.residentName}`,
                time: 'Just now',
                type: 'visitor'
            });
            loadActivities();
            
            alert('Visitor added successfully!');
        }

        function saveEmergency() {
            const residentSelect = document.getElementById('emergencyResident');
            const selectedResidentId = parseInt(residentSelect.value);
            const resident = residents.find(r => r.id === selectedResidentId);
            
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const reportedTime = `${year}-${month}-${day}T${hours}:${minutes}`;
            
            const newEmergency = {
                id: emergencies.length + 1,
                residentName: resident.name,
                room: resident.room,
                type: document.getElementById('emergencyType').value,
                description: document.getElementById('emergencyDescription').value,
                reportedTime: reportedTime,
                status: 'active',
                actionTaken: document.getElementById('emergencyAction').value || 'Pending',
                reportedBy: document.getElementById('emergencyReportedBy').value || resident.name
            };
            
            emergencies.push(newEmergency);
            loadEmergencyTable();
            closeModal('addEmergencyModal');
            updateDashboardStats();
            
            activities.unshift({
                id: activities.length + 1,
                description: `Emergency reported for ${resident.name} - ${newEmergency.type}`,
                time: 'Just now',
                type: 'emergency'
            });
            loadActivities();
            
            alert('Emergency logged successfully!');
        }

        function checkOutVisitor() {
            const visitorId = parseInt(document.getElementById('checkOutVisitorId').value);
            const checkOutTime = document.getElementById('visitorCheckOut').value;
            const remarks = document.getElementById('checkOutRemarks').value;
            
            const visitor = visitors.find(v => v.id === visitorId);
            if (visitor) {
                visitor.checkOut = checkOutTime;
                visitor.status = 'checked-out';
                visitor.checkOutRemarks = remarks;
                
                loadVisitorsTable();
                closeModal('checkOutVisitorModal');
                
                activities.unshift({
                    id: activities.length + 1,
                    description: `Visitor ${visitor.name} checked out`,
                    time: 'Just now',
                    type: 'visitor'
                });
                loadActivities();
                
                alert('Visitor checked out successfully!');
            }
        }

        function resolveEmergency() {
            const emergencyId = parseInt(document.getElementById('resolveEmergencyId').value);
            const resolution = document.getElementById('emergencyResolution').value;
            const resolvedBy = document.getElementById('emergencyResolvedBy').value;
            
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const resolvedTime = `${year}-${month}-${day}T${hours}:${minutes}`;
            
            const emergency = emergencies.find(e => e.id === emergencyId);
            if (emergency) {
                emergency.status = 'resolved';
                emergency.resolution = resolution;
                emergency.resolvedBy = resolvedBy;
                emergency.resolvedTime = resolvedTime;
                
                loadEmergencyTable();
                closeModal('resolveEmergencyModal');
                
                activities.unshift({
                    id: activities.length + 1,
                    description: `Emergency resolved for ${emergency.residentName}`,
                    time: 'Just now',
                    type: 'emergency'
                });
                loadActivities();
                
                alert('Emergency resolved successfully!');
            }
        }

        // Pagination Functions
        function previousPage(section) {
            console.log('Previous page for', section);
        }

        function nextPage(section) {
            console.log('Next page for', section);
        }

        // Action Functions
        function editResident(id) {
            const resident = residents.find(r => r.id === id);
            console.log('Edit resident:', resident);
            alert('Edit functionality - Resident ID: ' + id);
        }

        function viewResident(id) {
            const resident = residents.find(r => r.id === id);
            console.log('View resident:', resident);
            alert('View details - Resident ID: ' + id);
        }

        function deleteResident(id) {
            if (confirm('Are you sure you want to delete this resident?')) {
                residents = residents.filter(r => r.id !== id);
                loadResidentsTable();
                populateResidentDropdowns();
                updateDashboardStats();
                alert('Resident deleted successfully!');
            }
        }

        function viewPayment(id) {
            alert('View payment - ID: ' + id);
        }

        function downloadReceipt(id) {
            alert('Downloading receipt for payment ID: ' + id);
        }

        function viewVisitor(id) {
            alert('View visitor details - ID: ' + id);
        }

        function viewEmergency(id) {
            alert('View emergency details - ID: ' + id);
        }

        function updateComplaintStatus(id, status) {
            const complaint = complaints.find(c => c.id === id);
            if (complaint) {
                complaint.status = status;
                loadComplaintsGrid();
                alert(`Complaint #${id} marked as ${status}`);
            }
        }

        function collectPayment(id) {
            const due = dues.find(d => d.id === id);
            if (due) {
                alert(`Collect payment of ₹${due.amount} from ${due.residentName}`);
                dues = dues.filter(d => d.id !== id);
                loadDues();
            }
        }

        function generateReport() {
            alert('Generating payment report...');
        }

        // Settings Functions
        function savePGInfo() {
            const pgName = document.getElementById('pgName').value;
            const pgAddress = document.getElementById('pgAddress').value;
            const pgContact = document.getElementById('pgContact').value;
            
            console.log('Saving PG Info:', { pgName, pgAddress, pgContact });
            alert('PG information saved successfully!');
        }

        function saveRentSettings() {
            const singleRent = document.getElementById('singleSharingRent').value;
            const doubleRent = document.getElementById('doubleSharingRent').value;
            const tripleRent = document.getElementById('tripleSharingRent').value;
            const dueDate = document.getElementById('dueDate').value;
            
            console.log('Saving rent settings:', { singleRent, doubleRent, tripleRent, dueDate });
            alert('Rent settings saved successfully!');
        }

        function changePassword() {
            const currentPass = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (!currentPass || !newPass || !confirmPass) {
                alert('Please fill in all password fields');
                return;
            }
            
            if (newPass !== confirmPass) {
                alert('New password and confirm password do not match');
                return;
            }
            
            alert('Password changed successfully!');
        }

        // Logout Function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                alert('Logging out...');
            }
        }

        // Click outside modal to close
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>